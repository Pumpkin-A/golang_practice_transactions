1) В генераторе добавить с вер 50% ошибку сервера 503. +

2) В генераторе добавить проверку на наличие заголовка запроса X-User 
и проверкой значения, список доступных юзеров вынести в конфиг (создай 
структуру Config и  передавай её в конструкторы, куда надо). Отдавать 401 в случае ошибки. +

3) Клиента для генератора переделать с помщью фреймоворка chi +

4) Добавить проксирование заголовки от пользователя до сервиса генератора при запросах +

5) При получении ошибки 503 - пользователь знать не должен - он должен получить результат.
 При получении других ошибок - возвращать пользователю статус Bad Request с текстом ошибки. +